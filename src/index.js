import React, { useState } from "react";
import ReactDOM from "react-dom";

import "./styles.css";

const myCSVbase64 =
  "data:text/csv;base64,Y291bnRyeSwgY291bnRyeV9jb2RlDQpBZmdoYW5pc3RhbiwuYWYNCsOFbGFuZCwuYXgNCkFsYmFuaWEsLmFsDQpBbGdlcmlhLC5keg0KQW1lcmljYW4gU2Ftb2EsLmFzDQpBbmRvcnJhLC5hZA0KQW5nb2xhLC5hbw0KQW5ndWlsbGEsLmFpDQpBbnRhcmN0aWNhLC5hcQ0KQW50aWd1YSBhbmQgQmFyYnVkYSwuYWcNCkFyZ2VudGluYSwuYXINCkFybWVuaWEsLmFtDQpBcnViYSwuYXcNCkFzY2Vuc2lvbiBJc2xhbmQsLmFjDQpBdXN0cmFsaWEsLmF1DQpBdXN0cmlhLC5hdA0KQXplcmJhaWphbiwuYXoNCkJhaGFtYXMsLmJzDQpCYWhyYWluLC5iaA0KQmFuZ2xhZGVzaCwuYmQNCkJhcmJhZG9zLC5iYg0KQmFzcXVlIENvdW50cnksLmV1cw0KQmVsYXJ1cywuYnkNCkJlbGdpdW0sLmJlDQpCZWxpemUsLmJ6DQpCZW5pbiwuYmoNCkJlcm11ZGEsLmJtDQpCaHV0YW4sLmJ0DQpCb2xpdmlhLC5ibw0KQm9uYWlyZSwuYnENCkJvc25pYSBhbmQgSGVyemVnb3ZpbmEsLmJhDQpCb3Rzd2FuYSwuYncNCkJvdXZldCBJc2xhbmQsLmJ2DQpCcmF6aWwsLmJyDQpCcml0aXNoIEluZGlhbiBPY2VhbiBUZXJyaXRvcnksLmlvDQpCcml0aXNoIFZpcmdpbiBJc2xhbmRzLC52Zw0KQnJ1bmVpLC5ibg0KQnVsZ2FyaWEsLmJnDQpCdXJraW5hIEZhc28sLmJmDQpCdXJtYSAob2ZmaWNpYWxseTogTXlhbm1hciksLm1tDQpCdXJ1bmRpLC5iaQ0KQ2FtYm9kaWEsLmtoDQpDYW1lcm9vbiwuY20NCkNhbmFkYSwuY2ENCkNhcGUgVmVyZGUsLmN2DQpDYXRhbG9uaWEsLmNhdA0KQ2F5bWFuIElzbGFuZHMsLmt5DQpDZW50cmFsIEFmcmljYW4gUmVwdWJsaWMsLmNmDQpDaGFkLC50ZA0KQ2hpbGUsLmNsDQoiQ2hpbmEsIFBlb3BsZeKAmXMgUmVwdWJsaWMgb2YiLC5jbg0KQ2hyaXN0bWFzIElzbGFuZCwuY3gNCkNvY29zIChLZWVsaW5nKSBJc2xhbmRzLC5jYw0KQ29sb21iaWEsLmNvDQpDb21vcm9zLC5rbQ0KIkNvbmdvLCBEZW1vY3JhdGljIFJlcHVibGljIG9mIHRoZSAoQ29uZ28tS2luc2hhc2EpIiwuY2QNCiJDb25nbywgUmVwdWJsaWMgb2YgdGhlIChDb25nby1CcmF6emF2aWxsZSkiLC5jZw0KQ29vayBJc2xhbmRzLC5jaw0KQ29zdGEgUmljYSwuY3INCkPDtHRlIGTigJlJdm9pcmUgKEl2b3J5IENvYXN0KSwuY2kNCkNyb2F0aWEsLmhyDQpDdWJhLC5jdQ0KQ3VyYcOnYW8sLmN3DQpDeXBydXMsLmN5DQpDemVjaGlhIChDemVjaCBSZXB1YmxpYyksLmN6DQpEZW5tYXJrLC5kaw0KRGppYm91dGksLmRqDQpEb21pbmljYSwuZG0NCkRvbWluaWNhbiBSZXB1YmxpYywuZG8NCkVhc3QgVGltb3IgKFRpbW9yLUxlc3RlKSwudGwNCkVjdWFkb3IsLmVjDQpFZ3lwdCwuZWcNCkVsIFNhbHZhZG9yLC5zdg0KRXF1YXRvcmlhbCBHdWluZWEsLmdxDQpFcml0cmVhLC5lcg0KRXN0b25pYSwuZWUNCkV0aGlvcGlhLC5ldA0KRXVyb3BlYW4gVW5pb24sLmV1DQpGYWxrbGFuZCBJc2xhbmRzLC5maw0KRmFlcm9lIElzbGFuZHMsLmZvDQpGZWRlcmF0ZWQgU3RhdGVzIG9mIE1pY3JvbmVzaWEsLmZtDQpGaWppLC5mag0KRmlubGFuZCwuZmkNCkZyYW5jZSwuZnINCkZyZW5jaCBHdWlhbmEsLmdmDQpGcmVuY2ggUG9seW5lc2lhLC5wZg0KRnJlbmNoIFNvdXRoZXJuIGFuZCBBbnRhcmN0aWMgTGFuZHMsLnRmDQpHYWJvbiAob2ZmaWNpYWxseTogR2Fib25lc2UgUmVwdWJsaWMpLC5nYQ0KR2FsaWNpYSwuZ2FsDQpHYW1iaWEsLmdtDQpHYXphIFN0cmlwIChHYXphKSwucHMNCkdlb3JnaWEsLmdlDQpHZXJtYW55LC5kZQ0KR2hhbmEsLmdoDQpHaWJyYWx0YXIsLmdpDQpHcmVlY2UsLmdyDQpHcmVlbmxhbmQsLmdsDQpHcmVuYWRhLC5nZA0KR3VhZGVsb3VwZSwuZ3ANCkd1YW0sLmd1DQpHdWF0ZW1hbGEsLmd0DQpHdWVybnNleSwuZ2cNCkd1aW5lYSwuZ24NCkd1aW5lYS1CaXNzYXUsLmd3DQpHdXlhbmEsLmd5DQpIYWl0aSwuaHQNCkhlYXJkIElzbGFuZCBhbmQgTWNEb25hbGQgSXNsYW5kcywuaG0NCkhvbmR1cmFzLC5obg0KSG9uZyBLb25nLC5oaw0KSHVuZ2FyeSwuaHUNCkljZWxhbmQsLmlzDQpJbmRpYSwuaW4NCkluZG9uZXNpYSwuaWQNCklyYW4sLmlyDQpJcmFxLC5pcQ0KSXJlbGFuZCwuaWUNCklzbGUgb2YgTWFuLC5pbQ0KSXNyYWVsLC5pbA0KSXRhbHksLml0DQpKYW1haWNhLC5qbQ0KSmFwYW4sLmpwDQpKZXJzZXksLmplDQpKb3JkYW4sLmpvDQpLYXpha2hzdGFuLC5reg0KS2VueWEsLmtlDQpLaXJpYmF0aSwua2kNCkt1d2FpdCwua3cNCkt5cmd5enN0YW4sLmtnDQpMYW9zLC5sYQ0KTGF0dmlhLC5sdg0KTGViYW5vbiwubGINCkxlc290aG8sLmxzDQpMaWJlcmlhLC5scg0KTGlieWEsLmx5DQpMaWVjaHRlbnN0ZWluLC5saQ0KTGl0aHVhbmlhLC5sdA0KTHV4ZW1ib3VyZywubHUNCk1hY2F1LC5tbw0KIk1hY2Vkb25pYSwgTm9ydGgiLC5taw0KTWFkYWdhc2NhciwubWcNCk1hbGF3aSwubXcNCk1hbGF5c2lhLC5teQ0KTWFsZGl2ZXMsLm12DQpNYWxpLC5tbA0KTWFsdGEsLm10DQpNYXJzaGFsbCBJc2xhbmRzLC5taA0KTWFydGluaXF1ZSwubXENCk1hdXJpdGFuaWEsLm1yDQpNYXVyaXRpdXMsLm11DQpNYXlvdHRlLC55dA0KTWV4aWNvLC5teA0KTW9sZG92YSwubWQNCk1vbmFjbywubWMNCk1vbmdvbGlhLC5tbg0KTW9udGVuZWdybywubWUNCk1vbnRzZXJyYXQsLm1zDQpNb3JvY2NvLC5tYQ0KTW96YW1iaXF1ZSwubXoNCk15YW5tYXIsLm1tDQpOYW1pYmlhLC5uYQ0KTmF1cnUsLm5yDQpOZXBhbCwubnANCk5ldGhlcmxhbmRzLC5ubA0KTmV3IENhbGVkb25pYSwubmMNCk5ldyBaZWFsYW5kLC5ueg0KTmljYXJhZ3VhLC5uaQ0KTmlnZXIsLm5lDQpOaWdlcmlhLC5uZw0KTml1ZSwubnUNCk5vcmZvbGsgSXNsYW5kLC5uZg0KTm9ydGggQ3lwcnVzLC5uYy50cg0KTm9ydGggS29yZWEsLmtwDQpOb3J0aCBNYWNlZG9uaWEsLm1rDQpOb3J0aGVybiBNYXJpYW5hIElzbGFuZHMsLm1wDQpOb3J3YXksLm5vDQpPbWFuLC5vbQ0KUGFraXN0YW4sLnBrDQpQYWxhdSwucHcNClBhbGVzdGluZSwucHMNClBhbmFtYSwucGENClBhcHVhIE5ldyBHdWluZWEsLnBnDQpQYXJhZ3VheSwucHkNClBlcnUsLnBlDQpQaGlsaXBwaW5lcywucGgNClBpdGNhaXJuIElzbGFuZHMsLnBuDQpQb2xhbmQsLnBsDQpQb3J0dWdhbCwucHQNClB1ZXJ0byBSaWNvLC5wcg0KUWF0YXIsLnFhDQpSb21hbmlhLC5ybw0KUnVzc2lhLC5ydQ0KUndhbmRhLC5ydw0KUsOpdW5pb24gSXNsYW5kLC5yZQ0KU2FiYSwuYnENClNhaW50IEJhcnRow6lsZW15LC5ibA0KU2FpbnQgSGVsZW5hLC5zaA0KU2FpbnQgS2l0dHMgYW5kIE5ldmlzLC5rbg0KU2FpbnQgTHVjaWEsLmxjDQpTYWludCBNYXJ0aW4gKG9mZmljaWFsbHkgdGhlIENvbGxlY3Rpdml0eSBvZiBTYWludCBNYXJ0aW4pLC5tZg0KU2FpbnQtUGllcnJlIGFuZCBNaXF1ZWxvbiwucG0NClNhaW50IFZpbmNlbnQgYW5kIHRoZSBHcmVuYWRpbmVzLC52Yw0KU2Ftb2EsLndzDQpTYW4gTWFyaW5vLC5zbQ0KU8OjbyBUb23DqSBhbmQgUHLDrW5jaXBlLC5zdA0KU2F1ZGkgQXJhYmlhLC5zYQ0KU2VuZWdhbCwuc24NClNlcmJpYSwucnMNClNleWNoZWxsZXMsLnNjDQpTaWVycmEgTGVvbmUsLnNsDQpTaW5nYXBvcmUsLnNnDQpTaW50IEV1c3RhdGl1cywuYnENClNpbnQgTWFhcnRlbiwuc3gNClNsb3Zha2lhLC5zaw0KU2xvdmVuaWEsLnNpDQpTb2xvbW9uIElzbGFuZHMsLnNiDQpTb21hbGlhLC5zbw0KU29tYWxpbGFuZCwuc28NClNvdXRoIEFmcmljYSwuemENClNvdXRoIEdlb3JnaWEgYW5kIHRoZSBTb3V0aCBTYW5kd2ljaCBJc2xhbmRzLC5ncw0KU291dGggS29yZWEsLmtyDQpTb3V0aCBTdWRhbiwuc3MNClNwYWluLC5lcw0KU3JpIExhbmthLC5saw0KU3VkYW4sLnNkDQpTdXJpbmFtZSwuc3INClN2YWxiYXJkIGFuZCBKYW4gTWF5ZW4gSXNsYW5kcywuc2oNClN3YXppbGFuZCwuc3oNClN3ZWRlbiwuc2UNClN3aXR6ZXJsYW5kLC5jaA0KU3lyaWEsLnN5DQpUYWl3YW4sLnR3DQpUYWppa2lzdGFuLC50ag0KVGFuemFuaWEsLnR6DQpUaGFpbGFuZCwudGgNClRvZ28sLnRnDQpUb2tlbGF1LC50aw0KVG9uZ2EsLnRvDQpUcmluaWRhZCAmIFRvYmFnbywudHQNClR1bmlzaWEsLnRuDQpUdXJrZXksLnRyDQpUdXJrbWVuaXN0YW4sLnRtDQpUdXJrcyBhbmQgQ2FpY29zIElzbGFuZHMsLnRjDQpUdXZhbHUsLnR2DQpVZ2FuZGEsLnVnDQpVa3JhaW5lLC51YQ0KVW5pdGVkIEFyYWIgRW1pcmF0ZXMsLmFlDQpVbml0ZWQgS2luZ2RvbSwudWsNClVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSwudXMNClVuaXRlZCBTdGF0ZXMgVmlyZ2luIElzbGFuZHMsLnZpDQpVcnVndWF5LC51eQ0KVXpiZWtpc3RhbiwudXoNClZhbnVhdHUsLnZ1DQpWYXRpY2FuIENpdHksLnZhDQpWZW5lenVlbGEsLnZlDQpWaWV0bmFtLC52bg0KV2FsbGlzIGFuZCBGdXR1bmEsLndmDQpXZXN0ZXJuIFNhaGFyYSwuZWgNClllbWVuLC55ZQ0KWmFtYmlhLC56bQ0KWmltYmFid2UsLnp3";

function App() {
  const [selectedFile, selectFile] = useState("");
  const handleSubmit = e => {
    const event = e;
    event.preventDefault();
    console.log("selectedFile: ", selectedFile);
    // in case I want to access child state from parent. use hidden target input in the form element.
    // console.log("event.target>>", event.target.fileString.value);
    console.log("submitted!");
  };

  const handleChange = e => {
    const file = e.target.files[0];
    console.log("file type>>>", file.type);
    if (file.type === "text/csv") {
      const reader = new FileReader();
      reader.readAsDataURL(file);
      reader.onload = e => {
        const file = e.target.result;
        console.log("file>>>", file);
        selectFile(file);
      };
    } else {
      selectFile("");
    }
  };

  return (
    <div className="App">
      <h1>File Upload with React- Simple Example</h1>
      <form onSubmit={handleSubmit}>
        <input
          name="fileString"
          value={selectedFile}
          readOnly
          style={{ display: "none" }}
        />
        <input
          name="csvFile"
          type="file"
          onChange={handleChange}
          accept=".csv"
        />
        <button type="submit">Submit</button>
      </form>
      {selectedFile && (
        <a href={selectedFile} download>
          Download this
        </a>
      )}
    </div>
  );
}

const rootElement = document.getElementById("root");
ReactDOM.render(<App />, rootElement);
